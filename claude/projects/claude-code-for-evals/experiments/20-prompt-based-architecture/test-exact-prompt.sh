#!/bin/bash

echo "Testing the exact prompt that would be sent by the analyzer..."

# Create the exact prompt that would be used
cat > /tmp/test-analyzer-prompt.txt << 'EOF'
Find logical errors in this text section.

For each potential logical error:
1. Identify the specific claims or statements involved
2. Explain why they might be contradictory or inconsistent
3. Rate severity: critical (invalidates main argument), major (significant flaw), minor (small inconsistency)

Use this format for each finding:
FINDING: [line] | [severity] | [quote] | [explanation]

If you need to verify claims, note them as:
NEEDS_VERIFICATION: [claim] | [suggested search query]

Text section (lines 1-142):
# squiggle model

Author: Unknown
URL: N/A
Date: Sun Jul 06 2025 14:47:07 GMT-0700 (Pacific Daylight Time)

---

```squiggle
/*
Generated by Squiggle AI. Workflow ID: 99576ba5-db94-4528-b1ec-233b5c8520f7
*/
// Model to estimate impact of $5k/year UBI on US labor supply

import "hub:ozziegooen/sTest" as sTest

```

Note: You have access to these tools: verify_claim, check_definition. Use them as needed.
EOF

echo "Prompt size: $(wc -c < /tmp/test-analyzer-prompt.txt) bytes"
echo "Prompt lines: $(wc -l < /tmp/test-analyzer-prompt.txt)"

echo -e "\nTesting with timeout..."
cat /tmp/test-analyzer-prompt.txt | timeout 30 claude --print 2>&1 | head -20

rm -f /tmp/test-analyzer-prompt.txt